<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kavram Bilgi Yarışması</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e0f2f7; /* Light blue background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            box-sizing: border;
            overflow-x: hidden;
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        .container {
            background-color: #ffffff;
            border-radius: 0;
            box-shadow: none;
            max-width: 100%;
            width: 100%;
            height: 100vh;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            padding: 2.5rem 1rem;
            box-sizing: border-box;
            overflow-y: auto; /* Enable scrolling for editor content */
            padding-top: 2rem; /* Başlık için üstten boşluk */
        }
        .concept-box {
            min-width: 120px;
            max-width: 220px;
            min-height: 110px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #000000;
            font-size: 1.05rem;
            font-weight: bold;
            border-radius: 9999px;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s ease-in-out, background-color 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
            cursor: pointer;
            position: relative;
            animation: bubbleFloat var(--animation-duration) ease-in-out var(--animation-delay) infinite alternate;
        }
        .concept-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: inherit;
            background: radial-gradient(circle at 25% 25%, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%);
            pointer-events: none;
            z-index: 1;
        }
        .concept-box span {
            position: relative;
            z-index: 2;
            padding: 0.75rem 1rem;
            text-align: center;
            word-break: break-word;
            overflow-wrap: break-word;
            line-height: 1.2;
            display: block;
        }

        .concept-box:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        .concept-box.correct {
            background-color: #10B981;
            border-color: #047857;
            box-shadow: 0 0 35px rgba(16, 185, 129, 1);
            border-width: 5px;
            border-style: solid;
            transform: scale(1.08);
        }
        .concept-box.incorrect {
            border-color: #EF4444;
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.6);
        }
        .quiz-area {
            width: 100%;
            max-width: none;
            text-align: left;
            background: linear-gradient(to right, #A8D8FF, #4D94FF);
            border: 3px dashed #67a9cf;
            border-radius: 1rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        .question-line {
            display: flex;
            align-items: baseline;
            margin-bottom: 1.5rem;
            width: 100%;
        }
        .question-line h2 {
            margin-right: 0.5rem;
            margin-bottom: 0;
            flex-shrink: 0;
            font-size: 2.25rem;
        }
        .question-line p {
            flex-grow: 1;
            margin-bottom: 0;
            font-size: 1.5rem;
        }

        .message-box {
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            font-weight: 600;
            text-align: center;
            width: 100%;
        }
        .message-box.success {
            background-color: #d1fae5;
            color: #065f46;
        }
        .message-box.error {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .action-button {
            background-color: #3b82f6;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            width: 100%;
        }
        .action-button:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
        }
        .action-button:active {
            transform: translateY(0);
        }
        .button-group {
            display: flex;
            gap: 1rem;
            width: 100%;
            max-width: none;
            margin-top: 2rem;
            margin-bottom: 1rem;
            justify-content: center;
        }
        .button-group .action-button {
            flex: 1;
        }
        .reset-button {
            background-color: #6b7280;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            width: 100%;
            max-width: none;
        }
        .reset-button:hover {
            background-color: #4b5563;
        }

        /* Responsive grid for concept boxes */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            justify-content: center;
            gap: 1rem;
        }

        /* Timer display style */
        #timerDisplay {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            text-align: center;
            padding: 0.5rem 1rem;
            background-color: transparent;
            border-radius: 0.5rem;
            box-shadow: none;
            z-index: 10;
        }
        #timerDisplay.warning {
            color: #EF4444;
        }

        /* Checkmark icon style */
        .concept-box .checkmark {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            color: white;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .concept-box.correct .checkmark {
            opacity: 1;
        }


        /* Media queries for responsive column reduction/expansion */
        @media (max-width: 1200px) {
            .concept-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        @media (max-width: 992px) {
            .concept-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        @media (max-width: 768px) {
            .concept-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        @media (max-width: 640px) {
            .concept-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 480px) {
            .concept-grid {
                grid-template-columns: repeat(1, 1fr);
            }
        }

        /* Bubble animation definition */
        @keyframes bubbleFloat {
            0% { transform: translate(0px, 0px) scale(1); opacity: 0.9; }
            50% { transform: translate(var(--translate-x), var(--translate-y)) scale(1.02); opacity: 0.95; }
            100% { transform: translate(0px, 0px) scale(1); opacity: 0.9; }
        }

        /* Unit selection screen styles */
        #mainMenuScreen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            gap: 1.5rem;
            padding: 2rem;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        /* New unit grid style */
        .unit-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* Default 3 columns */
            gap: 1.5rem; /* Gap between cards */
            width: 90%; /* Occupy more width */
            max-width: 1200px; /* Max width for the grid */
            justify-items: center; /* Center items in the grid */
            margin: 0 auto; /* Added to center the grid itself */
            flex-grow: 1; /* Allow unit grid to grow and push button down */
            align-items: center; /* Center items vertically within the grid area */
        }
        .unit-card {
            padding: 1.5rem;
            border-radius: 1rem;
            width: 100%; /* Take full width of its grid column */
            aspect-ratio: 4/3; /* Maintain aspect ratio for better visual consistency */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            font-size: 1.25rem;
            font-weight: 600;
            color: #333; /* Darker text for better contrast on gradients */
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(0,0,0,0.1); /* Subtle border */
        }
        .unit-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        .unit-card.selected {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.6), 0 0 0 3px #3b82f6; /* Blue glow and thicker border */
            border-color: #3b82f6;
        }
        .main-quiz-content {
            display: none; /* Hidden by default */
            width: 100%;
            height: 100%;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        /* Editor specific styles - These are hidden in normal mode */
        #editorScreen {
            display: none;
        }
        .editor-section {
            display: none;
        }
        .editor-list-item {
            display: none;
        }
        .editor-controls {
            display: none;
        }
        .editor-form {
            display: none;
        }
        .editor-form-buttons {
            display: none;
        }

        /* Custom Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .modal-content h4 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }
        .modal-content input[type="text"],
        .modal-content textarea {
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #ccc;
            font-size: 1rem;
            width: 100%;
        }
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }
        .modal-buttons button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .modal-save-btn {
            background-color: #3b82f6;
            color: white;
        }
        .modal-save-btn:hover {
            background-color: #2563eb;
        }
        .modal-cancel-btn {
            background-color: #6b7280;
            color: white;
        }
        .modal-cancel-btn:hover {
            background-color: #4b5563;
        }
        .modal-confirm-btn {
            background-color: #f44336;
            color: white;
        }
        .modal-confirm-btn:hover {
            background-color: #da190b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-4xl font-bold text-gray-800 mb-6">Kavram Bilgi Yarışması</h1>

        <div id="mainMenuScreen">
            <div id="unitCardsContainer" class="unit-grid">
                </div>
            <button id="startQuizBtn" class="action-button px-8 py-3 text-xl" style="display: none;">Yarışmayı Başlat</button>
            </div>

        <div id="mainQuizContent" class="main-quiz-content">
            <div id="quizArea" class="quiz-area">
                <div class="question-line">
                    <h2 class="text-3xl font-bold text-gray-700">Soru:</h2>
                    <p id="questionText" class="text-xl text-gray-800"></p>
                </div>
                <div id="timerDisplay">50</div>
                <div id="feedback" class="message-box mt-4" style="display: none;"></div>
            </div>

            <div id="conceptBoxes" class="concept-grid w-full justify-items-center">
            </div>

            <div class="button-group">
                <button id="showAnswerBtn" class="action-button bg-gray-500 hover:bg-gray-700">Cevabı Göster</button>
                <button id="nextQuestionBtn" class="action-button">Sonraki Soru</button>
            </div>

            <button id="resetQuizBtn" class="reset-button">Yarışmayı Yeniden Başlat</button>
            <button id="returnToMainMenuFromQuizBtn" class="action-button bg-gray-500 hover:bg-gray-700 mt-4">Ana Menüye Dön</button>
        </div>

        <div id="editorScreen" style="display: none;"></div>
    </div>

    <div id="customModalOverlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h4 id="modalTitle"></h4>
            <p id="modalMessage" class="text-gray-700"></p>
            <input type="text" id="modalInput1" style="display: none;">
            <input type="text" id="modalInput2" style="display: none;">
            <textarea id="modalTextarea" style="display: none;"></textarea>
            <div class="modal-buttons">
                <button id="modalConfirmBtn" class="modal-confirm-btn" style="display: none;">Evet</button>
                <button id="modalSaveBtn" class="modal-save-btn" style="display: none;">Kaydet</button>
                <button id="modalCancelBtn" class="modal-cancel-btn">İptal</button>
            </div>
        </div>
    </div>

    <script>
        // Ünite ve kavram verileri
        // Bu veriler 5. sınıf Din Kültürü ve Ahlak Bilgisi müfredatına uygun olarak hazırlanmıştır.
        let units = [
            {
                id: 'unit1',
                name: 'Ünite 1: Allah İnancı',
                concepts: [
                    {
                        id: 'evrendeki-mukemmel-duzen',
                        name: 'Evrendeki Mükemmel Düzen',
                        color: 'bg-blue-600',
                        questions: [
                            { question: 'Evrendeki hiçbir şeyin tesadüfen olmadığını, aksine her şeyin mükemmel bir düzen içinde gerçekleştiğini gösteren durum nedir?' },
                            { question: 'Gezegenlerden insanlara, bitkilerden hayvanlara kadar her şeyin bir uyum ve denge içinde olduğu varlıklar bütününe ne denir?' },
                            { question: 'İnsanın varlıkların bir amaç için yaratıldığını ve kendiliğinden meydana gelemeyeceğini fark etmesi, neyin göstergesidir?' }
                        ]
                    },
                    {
                        id: 'allahin-varligi-ve-birligi',
                        name: 'Allah\'ın Varlığı ve Birliği',
                        color: 'bg-green-600',
                        questions: [
                            { question: 'Her kitabın bir yazarı, her tablonun bir ressamı olduğu gibi, kainattaki bu mükemmel düzenin de bir yaratıcısı ve sahibi olduğunu fark etmemiz, neye işaret eder?' },
                            { question: 'Bir şeyi yoktan var etme özelliği sadece kime aittir?' },
                            { question: 'Evrendeki birlik ve düzenin yalnızca bir ve tek olan Allah\'ın eseri olduğunu ifade eden inanç nedir?' }
                        ]
                    },
                    {
                        id: 'tevhit-inanci',
                        name: 'Tevhit İnancı',
                        color: 'bg-purple-600',
                        questions: [
                            { question: 'Allah\'ın (c.c.) bir ve tek olduğuna, O\'nun eşi ve benzerinin olmadığına inanmak, O\'na hiçbir şeyi şirk koşmadan ibadeti yalnızca Allah (c.c.) için yapmak İslam dininde hangi kavramla adlandırılır?' },
                            { question: 'İslam dininin temel inanç esaslarından biri ve özü olan kavram nedir?' }
                        ]
                    },
                    {
                        id: 'esmayihusna',
                        name: 'Esmayıhüsna',
                        color: 'bg-red-600',
                        questions: [
                            { question: 'Yüce Allah\'ı en iyi şekilde tanımamıza ve anlamamıza yardımcı olan güzel isimlerine ne denir?' },
                            { question: 'Arapça\'da "en güzel isimler" anlamına gelen ve Allah\'ın (c.c.) gücünü, mükemmelliğini ve benzersizliğini anlatan isimler bütününe ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'rahman',
                        name: 'Rahman',
                        color: 'bg-yellow-600',
                        questions: [
                            { question: 'Yaratılmış bütün varlıklara şefkat gösteren, fark gözetmeksizin insanlara merhamet eden, sürekli nimetler veren, rahmeti sonsuz olan Allah\'ın güzel ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) dünyadaki tüm varlıklara karşı gösterdiği genel merhametini ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'rahim',
                        name: 'Rahîm',
                        color: 'bg-indigo-600',
                        questions: [
                            { question: 'Yarattığı bütün varlıklara karşılık beklemeden nimetler veren, onları koruyan, esirgeyen, bağışlayan ve onlara merhamet eden Allah\'ın (c.c.), ahirette kendisine inanan kullarına şefkat etmesi ve onları ödüllendirmesi anlamına gelen ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) ahirette mümin kullarına özel olarak göstereceği merhametini ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'alim',
                        name: 'Âlim',
                        color: 'bg-pink-600',
                        questions: [
                            { question: 'Allah\'ın (c.c.), gizli ve açık ne varsa her şeyi bilmesi anlamına gelen ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) yaratılmışların bilmedikleri sırları ve gizlilikleri, bütün zaman ve mekanla sınırlı olmayacak şekilde bilmesini ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'basir',
                        name: 'Basir',
                        color: 'bg-teal-600',
                        questions: [
                            { question: 'Yüce Allah\'ın her şeyi görmesi anlamına gelen ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) görmek için herhangi bir göze ihtiyacı olmadan her şeyi eksiksiz görmesini ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'semi',
                        name: 'Semi',
                        color: 'bg-orange-600',
                        questions: [
                            { question: 'Yüce Allah\'ın her şeyi duyması anlamına gelen ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) duymak için herhangi bir kulağa ihtiyacı olmadan her sesi işitmesini ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'kadir',
                        name: 'Kadir',
                        color: 'bg-cyan-600',
                        questions: [
                            { question: 'Allah\'ın (c.c.) sonsuz kudretini ve sınırsız gücünü ifade eden, her şeye gücünün yetmesi anlamına gelen ismi nedir?' },
                            { question: 'Allah\'ın (c.c.) istediği her şeyi kolaylıkla gerçekleştirmesini ve O\'nın gücünün sınırının olmamasını ifade eden ismi nedir?' }
                        ]
                    },
                    {
                        id: 'ihlas-suresi',
                        name: 'İhlas Suresi',
                        color: 'bg-lime-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'de yer alan kısa surelerden biri olan ve Allah\'ın birliğini, eşsizliğini vurgulayan sure hangisidir?' },
                            { question: '"Samimiyet, doğruluk, temizlik ve saflık" anlamlarına gelen, Allah\'ın (c.c.) hoşnutluğunu gözetmeyi ve ikiyüzlülükten uzak durmayı ifade eden kavramın adını taşıyan sure hangisidir?' },
                            { question: 'Allah\'ın (c.c.) güzel isimlerinden Ehad ve Samed\'in yer aldığı sure hangisidir?' },
                            { question: '"O, doğurmamış ve doğmamıştır. O\'nun hiçbir dengi (eşi, benzeri) yoktur." ayetlerinin yer aldığı sure hangisidir?' }
                        ]
                    },
                    {
                        id: 'ehad',
                        name: 'Ehad',
                        color: 'bg-emerald-600',
                        questions: [
                            { question: 'Allah\'ın (c.c.) bir ve tek olması anlamına gelen ismi nedir?' },
                            { question: 'İhlas suresinde geçen ve Allah\'ın eşsizliğini vurgulayan ismi nedir?' }
                        ]
                    },
                    {
                        id: 'samed',
                        name: 'Samed',
                        color: 'bg-rose-600',
                        questions: [
                            { question: 'Yüce Allah\'ın hiçbir şeye muhtaç olmayıp bütün varlıkların kendisine muhtaç olduğunu ifade eden güzel ismi nedir?' },
                            { question: 'İhlas suresinde geçen ve Allah\'ın mutlak bağımsızlığını ve her şeyin O\'na muhtaç olduğunu belirten ismi nedir?' }
                        ]
                    }
                ]
            },
            {
                id: 'unit2',
                name: 'Ünite 2: Namaz',
                concepts: [
                    {
                        id: 'ibadet',
                        name: 'İbadet',
                        color: 'bg-blue-500',
                        questions: [
                            { question: 'Genel anlamda Allah\'ın hoşnutluğunu kazandıracak her türlü tutum ve davranışa ne denir?' },
                            { question: 'İnsanın yaratılış amacı ve Allah\'a teşekkür etme yolu olarak ifade edilen, Allah\'a karşı saygı ve bağlılığı gösteren davranışlar bütününe ne denir?' }
                        ]
                    },
                    {
                        id: 'namaz',
                        name: 'Namaz',
                        color: 'bg-green-500',
                        questions: [
                            { question: 'Sözlükte "yalvarmak, dua, rahmet, yardım" gibi anlamlara gelen ve dinî bir terim olarak tekbirle başlayıp selamla biten, belirli hareket ve sözlerden oluşan bedenî ibadete ne denir?' },
                            { question: 'Hz. Muhammed (sav)\'in "Cennetin anahtarı namaz, namazın anahtarı ise abdesttir." hadisinde vurgulanan, günde beş vakit kılınan farz ibadet nedir?' }
                        ]
                    },
                    {
                        id: 'farz',
                        name: 'Farz',
                        color: 'bg-red-500',
                        questions: [
                            { question: 'Allah\'ın (c.c.) yapılmasını kesin olarak emrettiği, terk edilmesi durumunda günah sayılan ibadetlere ne denir?' },
                            { question: 'Ergenlik çağına gelmiş her Müslüman\'ın günde beş vakit kılması gereken namazların hükmü nedir?' }
                        ]
                    },
                    {
                        id: 'vacip',
                        name: 'Vacip',
                        color: 'bg-yellow-500',
                        questions: [
                            { question: 'Farz kadar açık ve kesin olmamakla birlikte kılınması emredilen, terk edilmesi durumunda kınama veya azap gerektiren ibadetlere ne denir?' },
                            { question: 'Ramazan ve Kurban Bayramlarında kılınan bayram namazları ile yatsı namazından sonra kılınan vitir namazının hükmü nedir?' }
                        ]
                    },
                    {
                        id: 'nafile',
                        name: 'Nafile',
                        color: 'bg-purple-500',
                        questions: [
                            { question: 'Hz. Peygamber’in farz veya vacip olanlar dışında kıldığı, sevap kazanmak amacıyla yapılan ibadetlere ne denir?' },
                            { question: 'Beş vakit farz namazın öncesinde veya sonrasında kılınan namazlar, teravih namazı ve teheccüt namazı gibi ibadetler hangi namaz çeşidine örnektir?' }
                        ]
                    },
                    {
                        id: 'abdest',
                        name: 'Abdest',
                        color: 'bg-indigo-500',
                        questions: [
                            { question: 'Namaz başta olmak üzere bazı ibadetleri yerine getirmeden önce yapılan, belirli organların yıkanmasıyla gerçekleştirilen dinî temizliğe ne denir?' },
                            { question: 'Hz. Peygamber\'in "Cennetin anahtarı namaz, namazın anahtarı ise abdesttir." hadisinde namazın anahtarı olarak belirtilen temizlik nedir?' }
                        ]
                    },
                    {
                        id: 'gusul',
                        name: 'Gusül',
                        color: 'bg-teal-500',
                        questions: [
                            { question: 'Vücutta kuru yer kalmayacak şekilde tepeden tırnağa yıkanarak yapılan büyük temizliğe ne denir?' },
                            { question: 'Akıllı ve ergenlik çağına girmiş her Müslüman’ın bazı durumlarda (cünüplük, hayız, nifas gibi) alması farz olan boy abdesti nedir?' }
                        ]
                    },
                    {
                        id: 'teyemmum',
                        name: 'Teyemmüm',
                        color: 'bg-orange-500',
                        questions: [
                            { question: 'Suyun bulunmadığı veya kullanılamadığı durumlarda, temiz toprak veya toprak cinsinden bir maddeye eller sürülerek alınan abdest yerine geçen temizliğe ne denir?' }
                        ]
                    },
                    {
                        id: 'iftitah-tekbiri',
                        name: 'İftitah Tekbiri',
                        color: 'bg-cyan-500',
                        questions: [
                            { question: 'Namaza "Allahüekber" diyerek başlamaya ne denir?' },
                            { question: 'Namazın başlangıcında söylenen ve namaza giriş şartlarından biri olan tekbir nedir?' }
                        ]
                    },
                    {
                        id: 'kiyam',
                        name: 'Kıyam',
                        color: 'bg-lime-500',
                        questions: [
                            { question: 'Namazda ayakta durmaya ne denir?' },
                            { question: 'Namazın rükünlerinden biri olan ve ayakta Kur\'an okuma pozisyonunu ifade eden terim nedir?' }
                        ]
                    },
                    {
                        id: 'kiraat',
                        name: 'Kıraat',
                        color: 'bg-emerald-500',
                        questions: [
                            { question: 'Namazda Kur\'an okumaya ne denir?' },
                            { question: 'Namazın rükünlerinden biri olan ve Fatiha suresi ile birlikte zamm-ı sure okunmasını ifade eden terim nedir?' }
                        ]
                    },
                    {
                        id: 'ruku',
                        name: 'Rükû',
                        color: 'bg-rose-500',
                        questions: [
                            { question: 'Namazda elleri dizlere koyarak eğilmeye ne denir?' },
                            { question: 'Namazda kıyamdan sonra yapılan, belin bükülerek eğilme hareketine ne denir?' }
                        ]
                    },
                    {
                        id: 'secde',
                        name: 'Secde',
                        color: 'bg-fuchsia-500',
                        questions: [
                            { question: 'Alnı, burnu, avuç içlerini, dizleri ve ayak parmaklarını yere koyarak kapanmaya ne denir?' },
                            { question: 'Namazda rükûdan sonra yapılan, Allah\'a en yakın olunan ve alnın yere konulduğu pozisyona ne denir?' }
                        ]
                    },
                    {
                        id: 'kade-i-ahire',
                        name: 'Ka\'de-i Ahîre',
                        color: 'bg-violet-500',
                        questions: [
                            { question: 'Namazın sonunda Tahiyyat duasını okuyacak kadar oturmaya ne denir?' },
                            { question: 'Namazın son oturuşunda Tahiyyat, Salli-Barik ve Rabbena dualarının okunduğu rükün nedir?' }
                        ]
                    },
                    {
                        id: 'cemaat',
                        name: 'Cemaat',
                        color: 'bg-amber-500',
                        questions: [
                            { question: 'Namazda imama uymak üzere bir araya gelen insan topluluğuna ne denir?' },
                            { question: 'Hz. Muhammed (sav)\'in "Cemaatle kılınan namaz, tek başına kılınan namazdan yirmi yedi kat daha faziletlidir." hadisinde vurgulanan, birlikte namaz kılma şekli nedir?' }
                        ]
                    },
                    {
                        id: 'teravih-namazi',
                        name: 'Teravih Namazı',
                        color: 'bg-sky-500',
                        questions: [
                            { question: 'Sadece ramazan ayında yatsı namazının son sünnetinden sonra, vitir namazından önce kılınan nafile namaza ne denir?' },
                            { question: 'Ramazan gecelerinde kılınan, sünnet bir namaz olan ve genellikle yirmi rekattan oluşan namaz nedir?' }
                        ]
                    },
                    {
                        id: 'tahiyyat-duasi',
                        name: 'Tahiyyat Duası',
                        color: 'bg-gray-500',
                        questions: [
                            { question: 'Selam, ikram, ihsan, hürmet ve ibadet anlamlarına gelen ve namazlarda oturduğumuz zaman okunan duaya ne denir?' },
                            { question: 'Hz. Peygamber ile Yüce Allah arasındaki konuşmanın yer aldığı ve namazların son oturuşunda okunan dua nedir?' }
                        ]
                    }
                ]
            },
            {
                id: 'unit3',
                name: 'Ünite 3: Kur\'an-ı Kerim',
                concepts: [
                    {
                        id: 'kuran',
                        name: 'Kur\'an',
                        color: 'bg-blue-600',
                        questions: [
                            { question: 'Hz. Peygamber\'e vahiy yoluyla gelen, mushaflarda yazılı olan, değiştirilmeden nesilden nesile nakledilen, okunması ve yaşanmasıyla ibadet edilen Allah\'ın (cc) kelamına ne denir?' },
                            { question: 'Allah\'ın (cc) peygamberler aracılığıyla insanlara gönderdiği vahyi bildiren son ilahi kitap nedir?' }
                        ]
                    },
                    {
                        id: 'ayet',
                        name: 'Ayet',
                        color: 'bg-green-600',
                        questions: [
                            { question: 'Kur\'an surelerini oluşturan, harf, kelime veya cümlelerden meydana gelen bölümlere ne denir?' },
                            { question: 'Kur\'an-ı Kerim\'deki her bir cümleye veya kısa pasajlara ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'sure',
                        name: 'Sure',
                        color: 'bg-purple-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'de ayetlerden oluşan, başı ve sonu belli olan bağımsız bölümlere ne denir?' }
                        ]
                    },
                    {
                        id: 'cuz',
                        name: 'Cüz',
                        color: 'bg-red-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in yirmi sayfadan oluşan her bir bölümüne ne denir?' },
                            { question: 'Kur\'an-ı Kerim\'in kolay okunmasını ve takip edilmesini sağlayan, otuz eşit parçadan her birine ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'hatim',
                        name: 'Hatim',
                        color: 'bg-yellow-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'i başından sonuna kadar okumaya ne denir?' },
                            { question: 'Kur\'an\'ın tamamını baştan sona okuyarak bitirme eylemine ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'hafiz',
                        name: 'Hafız',
                        color: 'bg-indigo-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'i baştan sona ezberleyen kişiye ne denir?' },
                            { question: 'Kur\'an\'ı ezberleyerek koruyan ve gelecek nesillere aktaran kişiye verilen unvan nedir?' }
                        ]
                    },
                    {
                        id: 'inanc',
                        name: 'İnanç',
                        color: 'bg-pink-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in ana konularından Allah\'ın varlığı ve birliği, melekler, kitaplar, peygamberler, ahiret ve kaza-kader gibi temel esasları ele alan bölüm nedir?' },
                            { question: 'İslam\'ın altı temel esasını (imanın şartları) kapsayan konu başlığı nedir?' }
                        ]
                    },
                    {
                        id: 'ibadet-kuran',
                        name: 'İbadet (Kur\'an)',
                        color: 'bg-teal-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in ana konularından namaz, oruç, zekat, hac gibi Müslümanların yerine getirmesi gereken dinî yükümlülükleri açıklayan bölüm nedir?' },
                            { question: 'Kur\'an\'da detayları ve hükümleri belirtilen, Allah\'a kulluk amacıyla yapılan fiiller bütününe ne denir?' }
                        ]
                    },
                    {
                        id: 'ahlak',
                        name: 'Ahlak',
                        color: 'bg-orange-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in ana konularından Müslümanların birbirleriyle ilişkilerinde, toplumda ve bireysel yaşamda sergilemeleri gereken güzel davranışları ve erdemleri öğütleyen bölüm nedir?' },
                            { question: 'Kur\'an\'ın insanlara öğrettiği iyi huylar, güzel davranışlar ve erdemler bütününe ne denir?' }
                        ]
                    },
                    {
                        id: 'sosyal-hayat',
                        name: 'Sosyal Hayat',
                        color: 'bg-cyan-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in ana konularından aile ilişkileri, komşuluk hakları, alışverişte dürüstlük, adalet gibi toplumsal yaşamı düzenleyen ayetleri içeren bölüm nedir?' },
                            { question: 'Kur\'an\'ın bireylerin toplum içindeki ilişkilerini, hak ve sorumluluklarını düzenleyen hükümleri hangi konu başlığı altında incelenir?' }
                        ]
                    },
                    {
                        id: 'kissa',
                        name: 'Kıssa',
                        color: 'bg-lime-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'de geçmiş peygamberler ve kavimlerle ilgili, ibret alınması amaçlanan olaylara ne denir?' },
                            { question: 'Kur\'an\'da anlatılan, genellikle peygamberlerin ve onların ümmetlerinin başından geçen, ders çıkarılması hedeflenen hikayelere ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'kevser-suresi',
                        name: 'Kevser Suresi',
                        color: 'bg-emerald-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in en kısa suresi hangisidir?' },
                            { question: 'İhlas suresinden sonra en kısa surelerden biri olan ve Allah\'ın (c.c.) Peygamberimize verdiği bol nimetlerden bahseden sure hangisidir?' }
                        ]
                    },
                    {
                        id: 'bakara-suresi', // Yeni eklenen kavram
                        name: 'Bakara Suresi',
                        color: 'bg-blue-500', // Yeni renk
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'in en uzun suresi hangisidir?' }
                        ]
                    }
                ]
            },
            {
                id: 'unit4',
                name: 'Ünite 4: Peygamber Kıssaları',
                concepts: [
                    {
                        id: 'peygamber',
                        name: 'Peygamber',
                        color: 'bg-blue-600',
                        questions: [
                            { question: 'Allah\'ın (c.c.) insanlara doğru yolu göstermek için seçtiği ve vahiy gönderdiği kişilere ne denir?' },
                            { question: 'İnsanlar ve Allah (c.c.) arasındaki elçilik görevini üstlenen, ilahi mesajları insanlara ulaştıran şahsiyetlere ne ad verilir?' },
                            { question: 'Allah\'tan aldığı vahiyleri insanlara ulaştıran, onlara doğru yolu gösteren ve örnek olan kişilere ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'kissa-peygamber',
                        name: 'Kıssa (Peygamber)',
                        color: 'bg-green-600',
                        questions: [
                            { question: 'Kur\'an-ı Kerim\'de geçmiş peygamberlerin ve ümmetlerinin hayatlarından ibret alınacak olaylara ne denir?' },
                            { question: 'Hz. Nuh, Hz. İbrahim, Hz. Musa, Hz. İsa gibi peygamberlerin hayat hikayelerinin anlatıldığı bölümlere ne ad verilir?' },
                            { question: 'Kur\'an\'da anlatılan, genellikle peygamberlerin ve onların ümmetlerinin başından geçen, ders çıkarılması hedeflenen hikayelere ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'hz-nuh',
                        name: 'Hz. Nuh',
                        color: 'bg-purple-600',
                        questions: [
                            { question: 'Tufan olayı ile bilinen ve kavmini uzun yıllar tevhit inancına davet eden, Allah\'ın (c.c.) emriyle büyük bir gemi inşa eden peygamber kimdir?' },
                            { question: 'Kavmi tarafından alay edilmesine rağmen tebliğ görevine devam eden ve sonunda büyük bir tufanla helak olan kavminden kurtulan peygamber kimdir?' },
                            { question: 'Kavminin inkarcılığına karşı sabırla mücadele eden ve tufan sonrası yeryüzünde yeni bir başlangıç yapan peygamber kimdir?' }
                        ]
                    },
                    {
                        id: 'hz-ibrahim',
                        name: 'Hz. İbrahim',
                        color: 'bg-red-600',
                        questions: [
                            { question: 'Putlara tapan kavmİne karşı tevhit mücadelesi veren, ateşe atılmasına rağmen yanmayan ve Kâbe\'yi inşa eden peygamber kimdir?' },
                            { question: 'Allah\'ın dostu anlamına gelen "Halilullah" lakabıyla anılan ve tevhid inancının yayılmasında önemli rol oynayan peygamber kimdir?' },
                            { question: 'Oğlunu kurban etme emrine tereddütsüz itaat eden, büyük bir teslimiyet örneği gösteren peygamber kimdir?' }
                        ]
                    },
                    {
                        id: 'hz-musa',
                        name: 'Hz. Musa',
                        color: 'bg-yellow-600',
                        questions: [
                            { question: 'Firavun\'a karşı mücadele eden, asasıyla denizi yaran ve İsrailoğullarını Mısır\'dan çıkaran peygamber kimdir?' },
                            { question: 'Tur Dağı\'nda Allah (c.c.) ile konuşan ve kendisine Tevrat verilen peygamber kimdir?' },
                            { question: 'Haksızlığa karşı duran ve kavmini zulümden kurtarmak için mucizeler gösteren peygamber kimdir?' }
                        ]
                    },
                    {
                        id: 'hz-isa',
                        name: 'Hz. İsa',
                        color: 'bg-indigo-600',
                        questions: [
                            { question: 'Annesi Hz. Meryem olan, beşikte konuşan, ölüleri diriltme ve hastaları iyileştirme gibi mucizeler gösteren peygamber kimdir?' },
                            { question: 'Hristiyanlık dininin peygamberi olarak kabul edilen ve kendisine İncil verilen şahsiyet kimdir?' },
                            { question: 'Babası olmadan dünyaya gelen ve insanlara merhamet ve sevgi mesajları getiren peygamber kimdir?' }
                        ]
                    },
                    {
                        id: 'kureys-suresi',
                        name: 'Kureyş Suresi',
                        color: 'bg-pink-600',
                        questions: [
                            { question: 'Kureyş kabilesine verilen nimetlerden ve onların güvenliğinden bahseden, onları Allah\'a ibadet etmeye çağıran sure hangisidir?' },
                            { question: 'Kâbe\'nin korunması ve Kureyş kabilesinin kış ve yaz yolculuklarındaki ticari faaliyetlerinin güvenliği ile ilgili olan sure hangisidir?' },
                            { question: 'Ticaret ve güvenliğin önemini vurgulayan, Kureyşlilerin Allah\'a şükretmelerini öğütleyen sure hangisidir?' }
                        ]
                    },
                    {
                        id: 'ulul-azim-peygamberler',
                        name: 'Ulul Azm Peygamberler',
                        color: 'bg-gray-700',
                        questions: [
                            { question: 'Tebliğ görevinde büyük zorluklara katlanmış, azim ve sabır sahibi peygamberlere verilen özel isim nedir?' },
                            { question: 'Kur\'an\'da kendilerinden özel olarak bahsedilen, tebliğlerinde büyük direnişlerle karşılaşan ve üstün irade gösteren peygamberler kimlerdir?' }
                        ]
                    },
                    {
                        id: 'mucize',
                        name: 'Mucize',
                        color: 'bg-fuchsia-700',
                        questions: [
                            { question: 'Peygamberlerin, peygamberliklerini ispatlamak için Allah\'ın izniyle gösterdikleri, insanların benzerini yapmaktan aciz kaldığı olağanüstü olaylara ne denir?' },
                            { question: 'Hz. Musa\'nın asasının yılana dönüşmesi, Hz. İsa\'nın ölüleri diriltmesi gibi peygamberlere özgü ilahi destekli olaylara ne ad verilir?' }
                        ]
                    }
                ]
            },
            {
                id: 'unit5',
                name: 'Ünite 5: Mimari ve Dinî Motifler',
                concepts: [
                    {
                        id: 'cami',
                        name: 'Cami',
                        color: 'bg-blue-600',
                        questions: [
                            { question: 'Müslümanların bir araya geldiği, birlikte ibadet ettiği, özellikle cuma ve bayram namazlarının kılındığı büyük ibadethanelere ne denir?' },
                            { question: 'Sözlükte "toplayan, bir araya getiren" anlamlarına gelen ve Müslümanların ibadet mekânı olan yapı nedir?' }
                        ]
                    },
                    {
                        id: 'mescit',
                        name: 'Mescit',
                        color: 'bg-green-600',
                        questions: [
                            { question: 'Secde edilen yer anlamına gelen ve cami ile benzer anlamda kullanılan, daha küçük boyutlu ibadethanelere ne denir?' },
                            { question: 'Hz. Peygamber döneminde inşa edilen ve İslam\'ın ilk ibadethanelerinden biri olan yapıya ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'mihrap',
                        name: 'Mihrap',
                        color: 'bg-purple-600',
                        questions: [
                            { question: 'Camilerde Kâbe yönünü (kıble) gösteren ve imamın namaz kıldırırken durduğu, genellikle oyuk veya niş şeklinde olan yere ne denir?' },
                            { question: 'Namaz kılanların yönünü belirleyen, caminin kıble duvarında bulunan özel bölüme ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'minber',
                        name: 'Minber',
                        color: 'bg-red-600',
                        questions: [
                            { question: 'İmamın veya hatibin cemaatin göreceği ve cemaate sesini daha iyi duyurmak için çıktığı, merdivenli yüksekçe yere ne denir?' },
                            { question: 'Cuma ve bayram namazlarındaki hutbelerin okunduğu, caminin içinde yer alan özel yapı nedir?' }
                        ]
                    },
                    {
                        id: 'vaaz-kursusu',
                        name: 'Vaaz Kürsüsü',
                        color: 'bg-yellow-600',
                        questions: [
                            { question: 'Camide vaaz ve dinî konularda ders vermek için imamın veya hatibin oturduğu yüksekçe yere ne denir?' },
                            { question: 'Cami içinde dinî bilgilerin aktarıldığı, konuşmacının oturduğu veya durduğu özel platforma ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'kubbe',
                        name: 'Kubbe',
                        color: 'bg-indigo-600',
                        questions: [
                            { question: 'Yarım küre biçiminde olan ve caminin üzerini örten, genellikle büyük ve gösterişli mimari öğeye ne denir?' },
                            { question: 'Camilerin ana ibadet alanını kapatan, mimari ve estetik açıdan önemli olan tavan yapısına ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'sadirvan',
                        name: 'Şadırvan',
                        color: 'bg-pink-600',
                        questions: [
                            { question: 'Cami avlularında bulunan, üzeri kapalı veya açık abdest alma yerine ne denir?' },
                            { question: 'Cami külliyelerinde cemaatin abdest alması için yapılmış, genellikle ortasında fıskiyeli bir havuz bulunan yapıya ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'minare',
                        name: 'Minare',
                        color: 'bg-teal-600',
                        questions: [
                            { question: 'Müezzinin ezan okuduğu, sela verdiği, şerefesi olan yüksek ve ince yapılara ne denir?' },
                            { question: 'Camilerin yanında yükselen, ezan okumak için kullanılan uzun, ince kulelere ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'serefe',
                        name: 'Şerefe',
                        color: 'bg-orange-600',
                        questions: [
                            { question: 'Camilerde minarenin etrafını balkon gibi saran, müezzinin ezan okuduğu bölüme ne denir?' },
                            { question: 'Minarelerin gövdesini çevreleyen ve müezzinin ezan okuduğu platforma ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'kulliye',
                        name: 'Külliye',
                        color: 'bg-cyan-600',
                        questions: [
                            { question: 'Merkezinde cami olan ve medrese, imaret, hamam, hastane gibi farklı yapıları barındıran geniş merkezlere ne denir?' },
                            { question: 'Osmanlı mimarisinde bir caminin etrafında toplanmış, sosyal ve kültürel hizmetler sunan yapı topluluğuna ne ad verilir?' }
                        ]
                    },
                    {
                        id: 'selatin-camileri',
                        name: 'Selatin Camileri',
                        color: 'bg-lime-600',
                        questions: [
                            { question: 'Osmanlı Dönemi’nde padişahlar ve hanedan mensupları tarafından kendi imkânlarıyla yaptırılan, genellikle birden fazla minaresi olan büyük camilere ne denir?' },
                            { question: 'Fatih Camii, Süleymaniye Camii, Sultanahmet Camii gibi Osmanlı padişahları tarafından yaptırılan camilere verilen genel isim nedir?' }
                        ]
                    },
                    {
                        id: 'ulu-cami',
                        name: 'Ulu Cami',
                        color: 'bg-emerald-600',
                        questions: [
                            { question: 'Cuma namazının kılındığı ve şehrin en büyük ibadethaneleri olarak inşa edilen, genellikle birden fazla minaresi ve geniş avlusu olan camilere ne denir?' },
                            { question: 'Bursa Ulu Cami, Diyarbakır Ulu Cami gibi şehirlerin en büyük ve merkezi camilerine verilen isim nedir?' }
                        ]
                    },
                    {
                        id: 'mescid-i-nebevi',
                        name: 'Mescid-i Nebevi',
                        color: 'bg-rose-600',
                        questions: [
                            { question: 'Medine’de Hz. Peygamber’in kabrinin de bulunduğu, İslam\'ın en kutsal mekanlarından biri olan mescide ne denir?' },
                            { question: 'Hz. Muhammed (s.a.v.) tarafından Medine\'de inşa edilen ve onun kabrinin de yer aldığı cami nedir?' }
                        ]
                    },
                    {
                        id: 'mescid-i-aksa',
                        name: 'Mescid-i Aksa',
                        color: 'bg-fuchsia-600',
                        questions: [
                            { question: 'Kudüs’te bulunan ve Müslümanların ilk kıblesi olan, Miraç olayının başlangıç noktası kabul edilen mescit hangisidir?' },
                            { question: 'İslam\'ın üç büyük kutsal mescidinden biri ve Kudüs\'te yer alan yapı nedir?' }
                        ]
                    },
                    {
                        id: 'kabe',
                        name: 'Kâbe',
                        color: 'bg-violet-600',
                        questions: [
                            { question: 'Kur’an-ı Kerim’de Beytullah “Allah’ın (cc) evi” olarak anılan, Müslümanların namazda yöneldikleri ve hac ibadetinin merkezi olan yapı neresidir?' },
                            { question: 'Mekke\'de bulunan, etrafında tavaf yapılan ve İslam\'ın en kutsal yapısı kabul edilen küp şeklindeki bina nedir?' }
                        ]
                    }
                ]
            }
        ];

        // DOM elements selection for Quiz
        const mainMenuScreen = document.getElementById('mainMenuScreen');
        const unitCardsContainer = document.getElementById('unitCardsContainer');
        const startQuizBtn = document.getElementById('startQuizBtn');
        const mainQuizContent = document.getElementById('mainQuizContent');
        const questionText = document.getElementById('questionText');
        const conceptBoxesDiv = document.getElementById('conceptBoxes');
        const feedbackDiv = document.getElementById('feedback');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const showAnswerBtn = document.getElementById('showAnswerBtn');
        const resetQuizBtn = document.getElementById('resetQuizBtn');
        const timerDisplay = document.getElementById('timerDisplay');
        const returnToMainMenuFromQuizBtn = document.getElementById('returnToMainMenuFromQuizBtn');

        // Custom Modal DOM elements (still needed for alerts/confirms, but not for editor specific inputs)
        const customModalOverlay = document.getElementById('customModalOverlay');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalInput1 = document.getElementById('modalInput1');
        const modalInput2 = document.getElementById('modalInput2');
        const modalTextarea = document = document.getElementById('modalTextarea');
        const modalConfirmBtn = document.getElementById('modalConfirmBtn');
        const modalSaveBtn = document.getElementById('modalSaveBtn');
        const modalCancelBtn = document.getElementById('modalCancelBtn');

        let selectedUnitConcepts = [];
        let allQuestions = []; // Tüm soruları içerir
        let availableQuestions = []; // Henüz sorulmamış soruları içerir
        let answeredConceptIds = new Set(); // Tüm soruları cevaplanmış kavramların ID'lerini içerir

        const MIN_OPTIONS_PER_QUESTION = 8; // Her soru için gösterilecek minimum seçenek sayısı
        let currentQuestionData = null;

        let timer;
        let countdownInterval;
        let incorrectAttempts = 0;

        let selectedUnitId = null; // Bu, yüklemede otomatik olarak ayarlanacaktır

        // Ünite kartları için gradyan renk paleti
        const unitCardGradients = [
            'linear-gradient(to right, #6EE7B7, #34D399)', // Yeşil tonları
            'linear-gradient(to right, #93C5FD, #60A5FA)', // Mavi tonları
            'linear-gradient(to right, #FDBA74, #FB923C)', // Turuncu tonları
            'linear-gradient(to right, #C4B5FD, #A78BFA)', // Mor tonları
            'linear-gradient(to right, #FCA5A5, #F87171)', // Kırmızı tonları
            'linear-gradient(to right, #BEF264, #A3E635)', // Açık yeşil tonları
            'linear-gradient(to right, #FECACA, #FCA5A5)', // Açık kırmızı tonları
            'linear-gradient(to right, #BFDBFE, #93C5FD)', // Açık mavi tonları
            'linear-gradient(to right, #FDE68A, #FCD34D)', // Sarı tonları
            'linear-gradient(to right, #D8B4FE, #C084FC)'  // Açık mor tonları
        ];

        // --- Özel Modal Fonksiyonları (Normal mod için basitleştirilmiş) ---
        let modalResolve;

        function showModal(title, message, input1Config = null, input2Config = null, textareaConfig = null, isConfirm = false) {
            return new Promise((resolve) => {
                modalResolve = resolve;
                modalTitle.textContent = title;
                modalMessage.textContent = message;

                // Normal mod modallarında kullanılmadığı için tüm giriş alanlarını gizle
                modalInput1.style.display = 'none';
                modalInput2.style.display = 'none';
                modalTextarea.style.display = 'none';
                modalSaveBtn.style.display = 'none';

                if (isConfirm) {
                    modalConfirmBtn.style.display = 'block';
                } else {
                    // Basit uyarılar için "Tamam" olarak işlev gören bir "İptal" düğmesi gösterebiliriz
                    modalCancelBtn.textContent = 'Tamam';
                    modalConfirmBtn.style.display = 'none';
                }

                customModalOverlay.style.display = 'flex';
            });
        }

        modalCancelBtn.addEventListener('click', () => {
            customModalOverlay.style.display = 'none';
            modalCancelBtn.textContent = 'İptal'; // Düğme metnini sıfırla
            modalResolve(null); // İptal/Tamam'da null ile çöz
        });

        modalConfirmBtn.addEventListener('click', () => {
            customModalOverlay.style.display = 'none';
            modalResolve(true); // Onayda true ile çöz
        });

        // --- Yarışma Fonksiyonları ---

        // Ünite seçim kartlarını render et
        function renderUnitCards() {
            unitCardsContainer.innerHTML = '';
            // "Tüm Üniteler" seçeneğini her zaman en sona ekle
            const unitsForDisplay = units.filter(unit => unit.id !== 'all-units');
            const allUnitsConcept = units.find(unit => unit.id === 'all-units');
            if (allUnitsConcept) {
                unitsForDisplay.push(allUnitsConcept);
            }

            unitsForDisplay.forEach((unit, index) => {
                const unitCard = document.createElement('div');
                unitCard.className = `unit-card ${selectedUnitId === unit.id ? 'selected' : ''}`;
                unitCard.textContent = unit.name;
                unitCard.dataset.unitId = unit.id;
                
                // Gradyan rengini ata
                unitCard.style.background = unitCardGradients[index % unitCardGradients.length];

                unitCard.addEventListener('click', () => {
                    selectUnit(unit.id);
                });
                unitCardsContainer.appendChild(unitCard);
            });
            // Bir ünite seçiliyse yarışmayı başlat düğmesini göster
            if (selectedUnitId) {
                startQuizBtn.style.display = 'block';
            } else {
                startQuizBtn.style.display = 'none';
            }
        }

        // Bir ünite seç ve kavramlarını yarışma modu için hazırla
        function selectUnit(unitId) {
            selectedUnitId = unitId;
            const unit = units.find(u => u.id === unitId);
            selectedUnitConcepts = unit ? unit.concepts : [];
            answeredConceptIds.clear(); // Yeni ünite seçildiğinde cevaplanmış kavramları sıfırla
            prepareQuestions();
            renderUnitCards(); // Seçili durumu güncellemek için yeniden render et
            startQuizBtn.style.display = 'block'; // Düğmenin seçimden sonra görünür olduğundan emin ol
        }

        // Fisher-Yates karıştırma algoritması
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Tüm soruları seçilen ünitenin kavramlarından topla ve karıştır
        function prepareQuestions() {
            allQuestions = [];
            selectedUnitConcepts.forEach(concept => {
                concept.questions.forEach(q => {
                    allQuestions.push({
                        conceptId: concept.id,
                        conceptName: concept.name,
                        question: q.question
                    });
                });
            });
            shuffleArray(allQuestions);
            updateAvailableQuestions();
        }

        // Sorulabilecek sorular listesini güncelle
        function updateAvailableQuestions() {
            // answeredConceptIds'de olmayan (yani tüm soruları cevaplanmamış) kavramlara ait soruları filtrele
            availableQuestions = allQuestions.filter(q => !answeredConceptIds.has(q.conceptId));
            shuffleArray(availableQuestions);
        }

        /**
         * Bir öğenin yazı tipi boyutunu belirtilen boyutlara sığacak şekilde dinamik olarak ayarlar.
         * @param {HTMLElement} element Yazı tipi boyutu ayarlanması gereken HTML öğesi (örn. bir <span>).
         * @param {number} maxWidth Öğenin içeriği için izin verilen maksimum genişlik piksel cinsinden.
         */
        function adjustFontSize(element, maxWidth) {
            let fontSize = parseFloat(window.getComputedStyle(element).fontSize);
            const originalFontSize = 1.05 * 16;
            const minFontSizePx = 0.45 * 16;

            element.style.fontSize = originalFontSize + 'px';

            while (element.scrollWidth > maxWidth && fontSize > minFontSizePx) {
                fontSize -= 0.5;
                element.style.fontSize = fontSize + 'px';
            }
        }

        // Verilen kavramlar için kavram kutularını render et
        function renderConcepts(conceptsToRender) {
            conceptBoxesDiv.innerHTML = '';
            if (conceptsToRender.length === 0) {
                return;
            }

            conceptsToRender.forEach(concept => {
                const conceptBox = document.createElement('div');
                const isAnswered = answeredConceptIds.has(concept.id); // Tüm soruları cevaplanmış mı?
                conceptBox.className = `concept-box ${concept.color} p-4 shadow-md ${isAnswered ? 'correct' : ''}`;
                conceptBox.innerHTML = `<span>${concept.name}</span>
                                        <svg class="checkmark" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`;
                conceptBox.dataset.conceptId = concept.id;
                
                // Eğer kavramın tüm soruları cevaplanmışsa veya mevcut soru için doğru cevap değilse tıklanamaz yap
                if (!isAnswered) { // Sadece tüm soruları cevaplanmamışsa tıklanabilir yap
                    conceptBox.addEventListener('click', handleConceptBoxClick);
                } else {
                    conceptBox.classList.add('correct'); // Doğru olarak işaretli kalmalı
                    conceptBox.style.pointerEvents = 'none';
                    conceptBox.classList.remove('cursor-pointer');
                }

                const randomX = (Math.random() * 20 - 10) + 'px';
                const randomY = (Math.random() * 20 - 10) + 'px';
                const duration = (5 + Math.random() * 3) + 's';
                const delay = (Math.random() * 2) + 's';

                conceptBox.style.setProperty('--translate-x', randomX);
                conceptBox.style.setProperty('--translate-y', randomY);
                conceptBox.style.setProperty('--animation-duration', duration);
                conceptBox.style.setProperty('--animation-delay', delay);

                conceptBoxesDiv.appendChild(conceptBox);

                const conceptNameSpan = conceptBox.querySelector('span');
                const availableWidth = 220 - (2 * 16);
                adjustFontSize(conceptNameSpan, availableWidth);
            });
        }

        // Tüm kavram kutularının vurgularını ve durumlarını temizle
        function clearConceptBoxStates() {
            document.querySelectorAll('.concept-box').forEach(box => {
                const conceptId = box.dataset.conceptId;
                // Eğer kavramın tüm soruları cevaplanmamışsa, yanlış/doğru vurgularını kaldır
                if (!answeredConceptIds.has(conceptId)) {
                    box.classList.remove('correct', 'incorrect');
                    const originalConcept = units.flatMap(u => u.concepts).find(c => c.id === conceptId); // Tüm ünitelerden orijinal rengi bul
                    if (originalConcept) {
                        box.classList.remove(...selectedUnitConcepts.map(c => c.color)); // Mevcut renk sınıfını kaldır
                        box.classList.add(originalConcept.color); // Orijinal rengi ekle
                    }
                    box.style.pointerEvents = 'auto'; // Tıklanabilir yap
                    box.classList.add('cursor-pointer');
                } else {
                    // Tüm soruları cevaplanmışsa, doğru olarak işaretli kalmalı ve tıklanamaz olmalı
                    box.classList.add('correct');
                    box.style.pointerEvents = 'none';
                    box.classList.remove('cursor-pointer');
                }
            });
        }

        // Tüm kavram kutularındaki tıklamaları devre dışı bırak
        function disableConceptBoxClicks() {
            document.querySelectorAll('.concept-box').forEach(box => {
                box.style.pointerEvents = 'none';
                box.classList.remove('cursor-pointer');
            });
        }

        // Geri sayım sayacını başlat
        function startTimer() {
            clearInterval(countdownInterval);
            timer = 50;
            timerDisplay.textContent = timer;
            timerDisplay.classList.remove('warning');

            countdownInterval = setInterval(() => {
                timer--;
                timerDisplay.textContent = timer;

                if (timer <= 10) {
                    timerDisplay.classList.add('warning');
                }

                if (timer <= 0) {
                    clearInterval(countdownInterval);
                    timerDisplay.textContent = "0";
                    feedbackDiv.textContent = "Süreniz Doldu!";
                    feedbackDiv.className = "message-box error";
                    feedbackDiv.style.display = 'block';
                    disableConceptBoxClicks();
                }
            }, 1000);
        }

        // Geri sayım sayacını durdur
        function stopTimer() {
            clearInterval(countdownInterval);
            timerDisplay.classList.remove('warning');
        }

        // Mevcut soruyu ve seçeneklerini görüntüle
        function displayQuestion() {
            feedbackDiv.style.display = 'none';
            clearConceptBoxStates();
            showAnswerBtn.style.display = 'block';
            incorrectAttempts = 0; // Yeni soru için yanlış denemeleri sıfırla

            if (availableQuestions.length === 0) {
                questionText.textContent = "Tebrikler! Tüm kavramları tamamladınız.";
                feedbackDiv.textContent = "Yarışmayı yeniden başlatmak için aşağıdaki butonu kullanın veya başka bir ünite seçin.";
                feedbackDiv.className = "message-box success";
                feedbackDiv.style.display = 'block';
                disableConceptBoxClicks();
                nextQuestionBtn.style.display = 'none';
                showAnswerBtn.style.display = 'none';
                stopTimer();
                timerDisplay.style.display = 'none';
                return;
            }

            currentQuestionData = availableQuestions[0];
            questionText.textContent = currentQuestionData.question;

            const correctConcept = selectedUnitConcepts.find(c => c.id === currentQuestionData.conceptId);
            let optionsForCurrentQuestion = [correctConcept];

            // Doğru kavramı ve tüm soruları cevaplanmış kavramları filtrele
            let potentialIncorrectOptions = selectedUnitConcepts.filter(c =>
                c.id !== correctConcept.id && !answeredConceptIds.has(c.id)
            );

            shuffleArray(potentialIncorrectOptions);

            // MIN_OPTIONS_PER_QUESTION'a ulaşana kadar veya daha fazla potansiyel seçenek kalmayana kadar yanlış seçenekler ekle
            for (let i = 0; optionsForCurrentQuestion.length < MIN_OPTIONS_PER_QUESTION && i < potentialIncorrectOptions.length; i++) {
                optionsForCurrentQuestion.push(potentialIncorrectOptions[i]);
            }

            // Eğer hala MIN_OPTIONS_PER_QUESTION'dan az seçenek varsa,
            // (yani ünitede 8'den az benzersiz, tüm soruları cevaplanmamış kavram varsa)
            // seçenek sayısı 8'den az olabilir. Bu durumda, sadece mevcut olanları gösteririz.
            // Kullanıcının isteği doğrultusunda, tüm soruları bitmiş kavramlar seçenek olarak görünmeyecektir.

            shuffleArray(optionsForCurrentQuestion); // Son seçenekleri karıştır
            renderConcepts(optionsForCurrentQuestion); // Oluşturulan seçenekleri renderConcepts'e gönder
            
            timerDisplay.style.display = 'block';
            startTimer();
        }

        // Kavram kutusuna tıklama olayını yönet
        function handleConceptBoxClick(event) {
            const clickedBox = event.currentTarget;
            const clickedConceptId = clickedBox.dataset.conceptId;
            const correctConceptId = currentQuestionData.conceptId;

            clearConceptBoxStates(); // Şu anda render edilmiş tüm kutuların durumlarını temizle

            if (clickedConceptId === correctConceptId) {
                feedbackDiv.textContent = "Doğru cevap! 🎉";
                feedbackDiv.className = "message-box success";
                clickedBox.classList.remove(...selectedUnitConcepts.map(c => c.color));
                clickedBox.classList.add('correct');

                // Mevcut soruyu allQuestions'dan kaldır ki tekrar sorulmasın
                allQuestions = allQuestions.filter(q => !(q.conceptId === correctConceptId && q.question === currentQuestionData.question));

                // Bu kavram için tüm soruların bitip bitmediğini kontrol et
                const remainingQuestionsForThisConcept = allQuestions.filter(q => q.conceptId === correctConceptId);
                if (remainingQuestionsForThisConcept.length === 0) {
                    answeredConceptIds.add(correctConceptId); // Kavramı tamamen cevaplanmış olarak işaretle
                }
                
                disableConceptBoxClicks();
                showAnswerBtn.style.display = 'none';
                stopTimer();
            } else {
                incorrectAttempts++; // Yanlış denemeleri artır
                feedbackDiv.textContent = `Yanlış cevap, tekrar deneyin. Kalan hak: ${2 - incorrectAttempts}`;
                feedbackDiv.className = "message-box error";
                clickedBox.classList.add('incorrect');
                setTimeout(() => {
                    clickedBox.classList.remove('incorrect');
                }, 700);

                if (incorrectAttempts >= 2) { // 2 yanlış denemeye ulaşıldıysa kontrol et
                    stopTimer();
                    feedbackDiv.textContent = "İki kez yanlış cevap verdiniz! Süre durduruldu. Cevabı görmek için 'Cevabı Göster' butonuna tıklayabilirsiniz.";
                    feedbackDiv.className = "message-box error";
                    disableConceptBoxClicks();
                }
            }
            feedbackDiv.style.display = 'block';
        }

        // Cevabı Göster düğmesi mantığı
        showAnswerBtn.addEventListener('click', () => {
            const correctConceptId = currentQuestionData.conceptId;
            const correctConcept = selectedUnitConcepts.find(c => c.id === correctConceptId);
            const correctConceptName = correctConcept ? correctConcept.name : 'Bilinmiyor';

            feedbackDiv.textContent = `Doğru cevap: "${correctConceptName}"`;
            feedbackDiv.className = "message-box success";
            feedbackDiv.style.display = 'block';

            document.querySelectorAll('.concept-box').forEach(box => {
                if (box.dataset.conceptId === correctConceptId) {
                    const currentBgClass = Array.from(box.classList).find(cls => cls.startsWith('bg-'));
                    if (currentBgClass) {
                        box.classList.remove(currentBgClass);
                    }
                    box.classList.add('correct');
                }
            });
            disableConceptBoxClicks();
            // Cevap gösterildiğinde o kavramın tüm soruları bitmiş sayılmalı
            // Mevcut soruyu allQuestions'dan kaldır ki tekrar sorulmasın
            allQuestions = allQuestions.filter(q => !(q.conceptId === correctConceptId && q.question === currentQuestionData.question));

            // Bu kavram için tüm soruların bitip bitmediğini kontrol et
            const remainingQuestionsForThisConcept = allQuestions.filter(q => q.conceptId === correctConceptId);
            if (remainingQuestionsForThisConcept.length === 0) {
                answeredConceptIds.add(correctConceptId); // Kavramı tamamen cevaplanmış olarak işaretle
            }
            showAnswerBtn.style.display = 'none';
            stopTimer();
        });

        // Sonraki soruya geç
        nextQuestionBtn.addEventListener('click', () => {
            updateAvailableQuestions();
            displayQuestion();
        });

        // Yarışmayı yeniden başlat
        resetQuizBtn.addEventListener('click', () => {
            answeredConceptIds.clear(); // Cevaplanmış kavramları sıfırla
            prepareQuestions(); // Tüm soruları yeniden hazırla
            displayQuestion(); // İlk soruyu göster
            nextQuestionBtn.style.display = 'block';
            showAnswerBtn.style.display = 'block';
        });

        // --- Ekran Geçişleri ---

        // "Yarışmayı Başlat" tıklandığında bu fonksiyon çağrılır
        function startQuizFromMenu() {
            if (selectedUnitId) {
                mainMenuScreen.style.display = 'none';
                mainQuizContent.style.display = 'flex';
                resetQuizBtn.click(); // Seçilen ünite için yarışmayı başlat
            } else {
                showModal('Uyarı', 'Lütfen bir ünite seçin!', null, null, null, false);
            }
        }

        // "Yarışmayı Başlat" düğmesi için olay dinleyicisi
        startQuizBtn.addEventListener('click', startQuizFromMenu);

        // Yarışmadan ana menüye dönmek için olay dinleyicisi
        returnToMainMenuFromQuizBtn.addEventListener('click', () => {
            stopTimer();
            mainQuizContent.style.display = 'none';
            mainMenuScreen.style.display = 'flex';
            selectedUnitId = null; // Seçili üniteyi temizle
            answeredConceptIds.clear(); // Yarışma başlangıcı için temizle
            renderUnitCards(); // Seçim durumunu doğru göstermek için ünite kartlarını yeniden render et
        });

        // Yüklemede ilk render
        document.addEventListener('DOMContentLoaded', () => {
            // "Tüm Üniteler" seçeneğinin zaten eklenip eklenmediğini kontrol et
            const allUnitsExist = units.some(unit => unit.id === 'all-units');

            // "Ek Kavramlar" ünitesini units dizisinden kaldır
            units = units.filter(unit => unit.id !== 'additional-concepts-unit');

            if (!allUnitsExist) {
                // units dizisindeki tüm ünitelerin kavramlarını birleştir
                const allConceptsCombined = units.flatMap(unit => unit.concepts);

                // `units` dizisine yeni "Tüm Üniteler" birimini ekle
                units.push({
                    id: 'all-units',
                    name: 'Tüm Üniteler',
                    concepts: allConceptsCombined
                });
            }

            // Başlangıçta hiçbir ünite seçili olmasın, kullanıcının seçmesini bekleyelim
            selectedUnitId = null;

            renderUnitCards(); // Ana menüyü ilk göstermek için ünite kartlarını render et
            mainQuizContent.style.display = 'none'; // Yarışma içeriğinin başlangıçta gizli olduğundan emin ol
            mainMenuScreen.style.display = 'flex'; // Ana menünün başlangıçta görünür olduğundan emin ol
        });
    </script>
</body>
</html>
